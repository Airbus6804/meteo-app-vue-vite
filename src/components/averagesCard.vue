<script setup lang="ts">
import average from "./average.vue";

import { library } from "@fortawesome/fontawesome-svg-core";

/* import font awesome icon component */


import {
  faUmbrella,
  faTemperature2,
  faWater,
} from "@fortawesome/free-solid-svg-icons";

import Meteo from "./scripts/getData";

library.add(faUmbrella, faTemperature2, faWater);

function getIconName(icon: any) {
  return "fa-solid fa-" + icon.iconName;
}

//const latitude = $latitude, longitude

console.log(localStorage.getItem("latitude"))

const meteo = new Meteo(Number(localStorage.getItem("latitude")), Number(localStorage.getItem("longitude")));

const data = await meteo.getHourly();

//const data = {"time":["2023-03-04T00:00","2023-03-04T01:00","2023-03-04T02:00","2023-03-04T03:00","2023-03-04T04:00","2023-03-04T05:00","2023-03-04T06:00","2023-03-04T07:00","2023-03-04T08:00","2023-03-04T09:00","2023-03-04T10:00","2023-03-04T11:00","2023-03-04T12:00","2023-03-04T13:00","2023-03-04T14:00","2023-03-04T15:00","2023-03-04T16:00","2023-03-04T17:00","2023-03-04T18:00","2023-03-04T19:00","2023-03-04T20:00","2023-03-04T21:00","2023-03-04T22:00","2023-03-04T23:00","2023-03-05T00:00","2023-03-05T01:00","2023-03-05T02:00","2023-03-05T03:00","2023-03-05T04:00","2023-03-05T05:00","2023-03-05T06:00","2023-03-05T07:00","2023-03-05T08:00","2023-03-05T09:00","2023-03-05T10:00","2023-03-05T11:00","2023-03-05T12:00","2023-03-05T13:00","2023-03-05T14:00","2023-03-05T15:00","2023-03-05T16:00","2023-03-05T17:00","2023-03-05T18:00","2023-03-05T19:00","2023-03-05T20:00","2023-03-05T21:00","2023-03-05T22:00","2023-03-05T23:00","2023-03-06T00:00","2023-03-06T01:00","2023-03-06T02:00","2023-03-06T03:00","2023-03-06T04:00","2023-03-06T05:00","2023-03-06T06:00","2023-03-06T07:00","2023-03-06T08:00","2023-03-06T09:00","2023-03-06T10:00","2023-03-06T11:00","2023-03-06T12:00","2023-03-06T13:00","2023-03-06T14:00","2023-03-06T15:00","2023-03-06T16:00","2023-03-06T17:00","2023-03-06T18:00","2023-03-06T19:00","2023-03-06T20:00","2023-03-06T21:00","2023-03-06T22:00","2023-03-06T23:00","2023-03-07T00:00","2023-03-07T01:00","2023-03-07T02:00","2023-03-07T03:00","2023-03-07T04:00","2023-03-07T05:00","2023-03-07T06:00","2023-03-07T07:00","2023-03-07T08:00","2023-03-07T09:00","2023-03-07T10:00","2023-03-07T11:00","2023-03-07T12:00","2023-03-07T13:00","2023-03-07T14:00","2023-03-07T15:00","2023-03-07T16:00","2023-03-07T17:00","2023-03-07T18:00","2023-03-07T19:00","2023-03-07T20:00","2023-03-07T21:00","2023-03-07T22:00","2023-03-07T23:00","2023-03-08T00:00","2023-03-08T01:00","2023-03-08T02:00","2023-03-08T03:00","2023-03-08T04:00","2023-03-08T05:00","2023-03-08T06:00","2023-03-08T07:00","2023-03-08T08:00","2023-03-08T09:00","2023-03-08T10:00","2023-03-08T11:00","2023-03-08T12:00","2023-03-08T13:00","2023-03-08T14:00","2023-03-08T15:00","2023-03-08T16:00","2023-03-08T17:00","2023-03-08T18:00","2023-03-08T19:00","2023-03-08T20:00","2023-03-08T21:00","2023-03-08T22:00","2023-03-08T23:00","2023-03-09T00:00","2023-03-09T01:00","2023-03-09T02:00","2023-03-09T03:00","2023-03-09T04:00","2023-03-09T05:00","2023-03-09T06:00","2023-03-09T07:00","2023-03-09T08:00","2023-03-09T09:00","2023-03-09T10:00","2023-03-09T11:00","2023-03-09T12:00","2023-03-09T13:00","2023-03-09T14:00","2023-03-09T15:00","2023-03-09T16:00","2023-03-09T17:00","2023-03-09T18:00","2023-03-09T19:00","2023-03-09T20:00","2023-03-09T21:00","2023-03-09T22:00","2023-03-09T23:00","2023-03-10T00:00","2023-03-10T01:00","2023-03-10T02:00","2023-03-10T03:00","2023-03-10T04:00","2023-03-10T05:00","2023-03-10T06:00","2023-03-10T07:00","2023-03-10T08:00","2023-03-10T09:00","2023-03-10T10:00","2023-03-10T11:00","2023-03-10T12:00","2023-03-10T13:00","2023-03-10T14:00","2023-03-10T15:00","2023-03-10T16:00","2023-03-10T17:00","2023-03-10T18:00","2023-03-10T19:00","2023-03-10T20:00","2023-03-10T21:00","2023-03-10T22:00","2023-03-10T23:00"],"temperature":[28.4,28.3,28.2,28.2,28.1,28.2,28,28,28.1,28.2,28.2,28.3,28.7,28.7,28.7,28.7,28.8,28.9,29,29,29,28.9,28.7,28.6,28.4,28.2,27.9,27.8,27.7,27.6,27.6,27.8,28.1,28.2,28.4,28.5,28.7,28.8,28.8,28.8,28.8,28.8,28.9,28.7,28.4,28.4,28.4,28.4,28.3,28.2,28.2,28.1,27.9,27.8,27.8,27.7,27.8,27.9,28.1,28,28,28,28.1,28.4,28.6,28.7,29,28.8,28.8,28.8,28.8,28.8,28.5,28.4,28.4,28.5,28.5,28.4,28.4,28.5,28.6,28.5,28.3,28.5,28.6,28.7,28.7,28.7,28.1,28.1,28.3,28.3,28.5,28.7,28.8,28.9,28.9,28.7,28.4,28.1,28,27.9,27.9,27.8,27.6,27.5,27.6,27.8,28,28.1,28.2,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29,28.9,28.7,28.5,28.4,28.3,28.3,28.2,28.1,28.2,28.4,28.7,29,29.1,29.1,29.2,29.1,29.1,29,29.1,29.2,29.2,29.1,28.9,28.6,28.5,28.3,28.2,28.1,28.1,28.1,28.1,28.1,28.1,28.1,28,28,28.2,28.4,28.7,28.7,28.7,28.6,28.7,28.7,28.7,28.6,28.3],"apparent_temperature":[33.5,33.2,33.2,32.9,32.9,32.7,32.2,32.2,32,32.2,32.4,33.9,33.5,33.7,33.5,33.1,33,33.2,33.5,33.6,33.8,33.5,33.6,33.7,33.8,33.6,33.2,32.9,32.4,32.3,32.1,32.4,32.9,33.1,34.5,35.2,35.5,36.2,36.3,34.9,33.6,33.5,33.4,33.4,33.6,33.5,33.4,33.4,33.5,33.5,33.4,32.8,32.8,32.6,32.4,32.3,32.5,32.4,32.8,32.7,33.5,32.8,33.8,33.1,32.4,32.9,33.4,33.5,33.2,33.3,33.6,33.5,33.3,33,33.4,33.3,33.1,32.8,32.6,32.5,32.7,33,33.1,33.4,33.4,34.4,33.7,32.7,32.4,33,33.1,33.2,33.3,33.3,33.1,32.9,32.7,32.6,32.6,32.6,32.8,32.8,32.7,32.5,32.2,31.8,31.8,31.9,32,32,32.1,32,31.9,31.8,31.8,32,32.2,32.6,33,33.4,33.7,33.7,33.4,32.9,32.7,32.6,32.6,32.6,32.6,32.8,33.1,34.1,35,35.1,34.9,34.3,33.4,33.3,33.3,33.4,33.5,33.7,33.7,33.6,33.4,33.3,33.4,33.2,33.1,32.7,32.5,32.4,32.4,32.5,32.7,33,33.7,34.3,34.7,34.4,33.6,33.3,32.9,33.1,33.2,33.5,33.6,33.5],"weather_code":[95,95,95,95,95,80,3,2,2,2,2,80,1,2,2,2,3,3,3,3,3,3,80,80,80,80,95,80,80,80,80,2,1,1,1,1,1,1,1,1,2,2,2,2,80,80,2,2,80,2,80,95,95,95,95,95,80,3,3,95,80,80,3,3,3,3,2,2,2,2,3,2,95,80,80,3,3,3,3,3,3,95,96,80,80,3,3,3,96,80,80,3,3,3,3,3,3,95,95,95,80,80,80,96,96,96,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,80,80,80,80,80,80,3,3,3,2,2,2,3,3,3,3,3,3,2,2,2,80,80,80,80,80,80,96,96,96,3,3,3,3,3,3,3,3,3,3,3,3,80,80],"precipitation_probability":[48,56,63,71,75,80,84,61,39,16,14,12,10,7,3,0,4,9,13,22,30,39,38,36,35,38,42,45,45,45,45,40,34,29,24,18,13,9,4,0,0,0,0,5,11,16,22,29,35,37,40,42,39,35,32,25,17,10,8,5,3,4,5,6,13,19,26,29,32,35,31,27,23,25,27,29,21,14,6,9,13,16,15,14,13,17,22,26,35,43,52,50,47,45,43,41,39,39,39,39,37,34,32,29,26,23,19,14,10,9,7,6,7,9,10,10,10,10,7,3,0,8,15,23,22,20,19,22,26,29,25,20,16,14,12,10,9,7,6,7,9,10,13,16,19,20,22,23,24,25,26,27,28,29,24,18,13,11,8,6,6,6,6,8,11,13,13,13],"relative_humidity":[84,83,84,82,83,81,83,82,82,82,82,82,80,80,80,80,80,79,79,79,79,79,80,81,82,83,84,84,85,85,85,84,82,82,82,81,79,78,78,78,78,78,78,80,83,83,83,84,84,84,84,83,85,85,85,85,84,83,82,82,82,82,82,80,79,79,77,78,78,79,79,79,80,80,81,80,81,82,82,82,82,82,82,80,79,79,79,79,83,83,82,82,82,81,80,79,79,80,82,84,85,85,85,86,87,87,86,85,83,82,82,82,82,82,82,82,81,80,79,78,78,79,80,81,82,82,83,83,83,83,82,81,79,78,78,78,78,79,80,80,79,79,80,81,82,83,85,86,86,84,83,83,83,83,83,84,84,83,81,80,80,81,81,81,80,80,81,83]}

const {relative_humidity, apparent_temperature: temperature, precipitation_probability } = data;


let totHumidity = 0;
let totTemperature = 0;
let totRain = 0;

for(let i = 0; i < 24; i++){
    totHumidity += relative_humidity[i];
    totTemperature += temperature[i];
    totRain += precipitation_probability[i];
}

const averageHumidity = totHumidity / 24;
const averageTemperature = totTemperature / 24;
const averageRain = totRain / 24;

console.log(await meteo.getLocationInfo())

</script>

<template>
  <section class="averagesCard">
    <average :icon="getIconName(faTemperature2)" :data="averageTemperature" name="Average Temp."></average>
    <average :icon="getIconName(faUmbrella)" :data="averageRain" name="Average Rain."></average>
    <average :icon="getIconName(faWater)" :data="averageHumidity" name="Average Humidity"></average>
  </section>
</template>

<style scoped lang="scss">
.averagesCard {
  background-color: rgba(255, 255, 255, 0.5);
  border-radius: 1rem;
  padding: 1rem;
  display: flex;
}
</style>
